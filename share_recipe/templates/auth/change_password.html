{% extends 'base.html' %}

{% block head %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='profile.css') }}">
{% endblock %}

{% block title %}Đổi mật khẩu{% endblock %}

{% block content %}
<div class="profile-container">
    <div class="change-password-section">
        <h1>Đổi mật khẩu</h1>
        
        <form method="post" class="password-form">
            <div class="form-group">
                <label for="current_password">Mật khẩu hiện tại</label>
                <input type="password" id="current_password" name="current_password" required>
            </div>

            <div class="form-group">
                <label for="new_password">Mật khẩu mới</label>
                <input type="password" id="new_password" name="new_password" required>
                <div class="password-strength" id="password-strength"></div>
            </div>

            <div class="form-group">
                <label for="confirm_password">Xác nhận mật khẩu mới</label>
                <input type="password" id="confirm_password" name="confirm_password" required>
                <div class="password-match" id="password-match"></div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-save">
                    <i class="fas fa-key"></i> Đổi mật khẩu
                </button>
                <a href="{{ url_for('auth.profile') }}" class="btn btn-cancel">
                    <i class="fas fa-times"></i> Hủy
                </a>
            </div>
        </form>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const newPassword = document.getElementById('new_password');
    const confirmPassword = document.getElementById('confirm_password');
    const strengthDiv = document.getElementById('password-strength');
    const matchDiv = document.getElementById('password-match');

    // Kiểm tra độ mạnh của mật khẩu
    newPassword.addEventListener('input', function() {
        const password = this.value;
        let strength = 0;
        let message = '';

        if (password.length >= 8) strength++;
        if (password.match(/[a-z]/)) strength++;
        if (password.match(/[A-Z]/)) strength++;
        if (password.match(/[0-9]/)) strength++;
        if (password.match(/[^a-zA-Z0-9]/)) strength++;

        switch(strength) {
            case 0:
            case 1:
                message = '<span class="weak">Yếu</span>';
                break;
            case 2:
            case 3:
                message = '<span class="medium">Trung bình</span>';
                break;
            case 4:
            case 5:
                message = '<span class="strong">Mạnh</span>';
                break;
        }

        strengthDiv.innerHTML = `Độ mạnh: ${message}`;
    });

    // Kiểm tra mật khẩu khớp
    confirmPassword.addEventListener('input', function() {
        if (this.value === newPassword.value) {
            matchDiv.innerHTML = '<span class="match">Mật khẩu khớp</span>';
        } else {
            matchDiv.innerHTML = '<span class="not-match">Mật khẩu không khớp</span>';
        }
    });
});
</script>
{% endblock %} 